<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Panel de Contabilidad</title>
    
    <link rel="stylesheet" href="styles.css" />

    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <div id="app-container">
        
        <nav class="top-nav">
            <div class="nav-item active" id="tab-sheets" onclick="switchTab('sheets')">
                <span>ğŸ—‚ï¸ Contabilidad</span>
            </div>
            <div class="nav-item" id="tab-config" onclick="switchTab('config')">
                <span>âš™ï¸</span>
            </div>
        </nav>

        <div id="global-status-bar" class="status-success">âœ… Listo.</div>

        <div id="view-sheets" class="content-view active">
            <ul id="sheet-list" class="sheet-list">
                <li class="loading-state">â³ Cargando hojas de Excel...</li>
            </ul>
            <button id="btn-refresh" class="action-btn secondary">ğŸ”„ Actualizar Lista</button>
        </div>

        <div id="view-config" class="content-view hidden">
            <div class="config-section">
                <h3>General</h3>
                
                <div class="toggle-row">
                    <label class="switch">
                        <input type="checkbox" id="toggle-auto-reorder">
                        <span class="slider round"></span>
                    </label>
                    <span>Reordenamiento AutomÃ¡tico</span>
                </div>

                <div class="toggle-row">
                    <label class="switch">
                        <input type="checkbox" id="toggle-headers">
                        <span class="slider round"></span>
                    </label>
                    <span>Mostrar Encabezados</span>
                </div>
            </div>

            <div class="config-section">
                <h3>DiagnÃ³stico y Logs</h3>
                
                <div class="toggle-row">
                    <label class="switch">
                        <input type="checkbox" id="toggle-clear-on-load">
                        <span class="slider round"></span>
                    </label>
                    <span>Limpiar Consola al Iniciar</span>
                </div>
                
                <button id="btn-clear-console-manual" class="action-btn secondary">ğŸ§¹ Limpiar Logs Ahora</button>

                <p class="info-info">Usa Volcar Datos si el Arquitecto solicita el estado del entorno.</p>
                <button id="btn-debug-dump" class="action-btn primary">ğŸ’¾ Volcar Datos de DepuraciÃ³n</button>
                <textarea id="debug-output" readonly placeholder="El resultado aparecerÃ¡ aquÃ­..."></textarea>
                <button id="btn-copy-debug" class="action-btn secondary hidden">ğŸ“‹ Copiar al Portapapeles</button>
            </div>
        </div>

    </div>
    <script type="text/javascript" src="taskpane.js"></script>
</body>
</html>
